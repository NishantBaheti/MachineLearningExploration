

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Decision Tree Algorithm &mdash; Machine Learning Exploration 1.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> Machine Learning Exploration
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../PracticalStatistics/Statistics.html">Statisitcs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../PracticalStatistics/Statistics.html#Probability-Distributions">Probability Distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../PracticalStatistics/z_score.html">Z Score</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../PracticalStatistics/Hypothesis.html">Hypothesis Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../PracticalStatistics/StatisticalModelling.html">Statistical Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../PandasExploration/PandasExploration.html">Pandas Exploration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../MatplotlibExploration/visualization.html">Matplotlib Visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../MathExploration/SingularValueDecomposition.html">Singular Value Decomposition</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../MathExploration/PrincipalComponentAnalysis.html">Principal Component Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../LinearRegression/Explore.html">Linear Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../LinearRegression/Explore.html#Ridge(L2-Regularization)-Regression">Ridge(L2 Regularization) Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../LinearRegression/Explore.html#Lasso(L1-Regularization)-Regression">Lasso(L1 Regularization) Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../LinearRegression/Explore.html#Comparing-Linear,-Lasso,-Ridge-Regression">Comparing Linear, Lasso, Ridge Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../LogisticRegression/Explore.html">Logistic Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../TreeBasedModels/ExploreDecisionTree.html">Decision Tree Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../TreeBasedModels/ExploreRandomForest.html">Random Forest Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../IrisDataAnalysis/IrisDataExploratoryAnalysis.html">Iris Data Exploratory Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../BreastCancerAnalysis/BreastCancerPreprocessingAnalysis.html">Breast Cancer Preprocessing Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../BreastCancerAnalysis/BreastCancerModellingAnalysis.html">Breast Cancer Analytical Modelling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../BreastCancerAnalysis/plot_learning_curve.html">Plotting Learning Curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ChurnClassification/ChurnClassificationModelling.html">Churn Classification Modelling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../DigitsDataAnalysis/DigitsDataModelling.html">Digits Data Analysis and Modelling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../NaturalLanguageProcessing/NLTK.html">Natural Language Processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../SpamDetection/SpamDataAnalytics.html">Spam Data Analytics</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Machine Learning Exploration</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
      <li>Decision Tree Algorithm</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/docs/docs/TreeBasedModels/ExploreDecisionTree.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Decision-Tree-Algorithm">
<h1>Decision Tree Algorithm<a class="headerlink" href="#Decision-Tree-Algorithm" title="Permalink to this headline">¶</a></h1>
<p>Decision trees can be applied to both regression and classification problems. It is one of the predictive modelling approaches used in statistics, data mining and machine learning. It uses a decision tree (as a predictive model) to go from observations about an item (represented in the branches) to conclusions about the item’s target value (represented in the leaves). Tree models where the target variable can take a discrete set of values are called classification trees; in these tree
structures, leaves represent class labels and branches represent conjunctions of features that lead to those class labels. Decision trees where the target variable can take continuous values (typically real numbers) are called regression trees. Decision trees are among the most popular machine learning algorithms given their intelligibility and simplicity.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">dummy_train_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="s1">&#39;Green&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;Apple&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;Red&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;Apple&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;Red&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Grape&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;Red&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Grape&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;Yellow&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;Lemon&#39;</span><span class="p">],</span>
<span class="p">],</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;O&#39;</span><span class="p">)</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">,</span><span class="s1">&#39;diameter&#39;</span><span class="p">,</span><span class="s1">&#39;fruit&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="CART(Classification-and-Regression-Trees)">
<h2>CART(Classification and Regression Trees)<a class="headerlink" href="#CART(Classification-and-Regression-Trees)" title="Permalink to this headline">¶</a></h2>
<p>The representation for the CART model is a binary tree.</p>
<p>This is your binary tree from algorithms and data structures, nothing too fancy. Each root node represents a single input variable (x) and a split point on that variable (assuming the variable is numeric).</p>
<p>The leaf nodes of the tree contain an output variable (y) which is used to make a prediction.</p>
<p>Given a dataset with two inputs (x) of height in centimeters and weight in kilograms the output of sex as male or female, below is a crude example of a binary decision tree (completely fictitious for demonstration purposes only).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>                         Is diameter &gt;= 3 ?
                                  |
                     _____________|_____________
                True|                           |False
                    |                           |
           Is color == Yellow ?               Grape
                  |
     _____________|_____________
True|                           |False
    |                           |
   Lemon                      Apple
</pre></div>
</div>
</div>
<div class="section" id="Question(Parition-concept-of-the-dataset)">
<h2>Question(Parition concept of the dataset)<a class="headerlink" href="#Question(Parition-concept-of-the-dataset)" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>like a <code class="docutils literal notranslate"><span class="pre">Threshold</span></code></p></li>
<li><p>Question is a concept for split the node.</p></li>
<li><p>It represents a True or False question.</p></li>
<li><p>match to see if it will go to true branch or false branch</p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>

<span></span><span class="k">class</span> <span class="nc">Question</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column_index</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">header</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">column_index</span> <span class="o">=</span> <span class="n">column_index</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">header</span> <span class="o">=</span> <span class="n">header</span>

    <span class="k">def</span> <span class="nf">match</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">example</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">example</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">example</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">example</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;O&quot;</span><span class="p">)</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">example</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">column_index</span><span class="p">]</span>

        <span class="c1"># adding numpy int and float data types as well</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)):</span>
            <span class="c1"># a condition for question to return True or False for numeric value</span>
            <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>  <span class="c1"># categorical data comparison</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="s2">&quot;==&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)):</span>
            <span class="n">condition</span> <span class="o">=</span> <span class="s2">&quot;&gt;=&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Is </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">condition</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2"> ?&quot;</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">q1</span> <span class="o">=</span> <span class="n">Question</span><span class="p">(</span><span class="n">column_index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="s1">&#39;apple&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="s1">&#39;fruit&#39;</span><span class="p">)</span>
<span class="n">q1</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Is fruit == apple ?
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">q1</span><span class="o">.</span><span class="n">match</span><span class="p">([</span><span class="s1">&#39;apple&#39;</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">q2</span> <span class="o">=</span> <span class="n">Question</span><span class="p">(</span><span class="n">column_index</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="s1">&#39;weight&#39;</span><span class="p">)</span>
<span class="n">q2</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Is weight &gt;= 30 ?
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">q2</span><span class="o">.</span><span class="n">match</span><span class="p">([</span><span class="s1">&#39;apple&#39;</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
False
</pre></div></div>
</div>
</div>
<div class="section" id="Partition-rows">
<h2>Partition rows<a class="headerlink" href="#Partition-rows" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p>partition rows in true side and false side using the Question we have already defined.</p></li>
<li><p>here fruit is the target and questions are used to divide the values of target</p></li>
<li><p>first question here ‘is the color red’</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>          [&#39;color&#39;,&#39;diameter&#39;,&#39;fruit&#39;]

           [[&#39;Green&#39;, 3, &#39;Apple&#39;],
           [&#39;Red&#39;, 3, &#39;Apple&#39;],
           [&#39;Red&#39;, 1, &#39;Grape&#39;],
           [&#39;Red&#39;, 1, &#39;Grape&#39;],
           [&#39;Yellow&#39;, 3, &#39;Lemon&#39;]]

              Is color == Red ?
                       |
          _____________|_____________
     True|                           |False
         |                           |
[[&#39;Red&#39;, 3, &#39;Apple&#39;],          [[&#39;Green&#39;, 3, &#39;Apple&#39;],
[&#39;Red&#39;, 1, &#39;Grape&#39;],           [&#39;Yellow&#39;, 3, &#39;Lemon&#39;]]
[&#39;Red&#39;, 1, &#39;Grape&#39;]]
</pre></div>
</div>
</li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">partition</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">question</span><span class="p">):</span>
    <span class="n">true_idx</span><span class="p">,</span> <span class="n">false_idx</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">question</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
            <span class="n">true_idx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">false_idx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">true_idx</span><span class="p">,</span> <span class="n">false_idx</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">dummy_train_data</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[&#39;Green&#39;, 3, &#39;Apple&#39;],
       [&#39;Red&#39;, 3, &#39;Apple&#39;],
       [&#39;Red&#39;, 1, &#39;Grape&#39;],
       [&#39;Red&#39;, 1, &#39;Grape&#39;],
       [&#39;Yellow&#39;, 3, &#39;Lemon&#39;]], dtype=object)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">Question</span><span class="p">(</span><span class="n">column_index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="s1">&#39;Red&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="n">headers</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Is color == Red ?
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">partition</span><span class="p">(</span><span class="n">dummy_train_data</span><span class="p">,</span><span class="n">Question</span><span class="p">(</span><span class="n">column_index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="s1">&#39;Red&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="n">headers</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">dummy_train_data</span><span class="p">[</span><span class="n">left</span><span class="p">,:]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[&#39;Red&#39;, 3, &#39;Apple&#39;],
       [&#39;Red&#39;, 1, &#39;Grape&#39;],
       [&#39;Red&#39;, 1, &#39;Grape&#39;]], dtype=object)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">dummy_train_data</span><span class="p">[</span><span class="n">right</span><span class="p">,:]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[&#39;Green&#39;, 3, &#39;Apple&#39;],
       [&#39;Yellow&#39;, 3, &#39;Lemon&#39;]], dtype=object)
</pre></div></div>
</div>
</div>
<div class="section" id="Tree-Node---Leaf-node,-Decision-Node">
<h2>Tree Node - Leaf node, Decision Node<a class="headerlink" href="#Tree-Node---Leaf-node,-Decision-Node" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>                 Decision Node -&gt;     Is diameter &gt;= 3 ?

                                              |
                                 _____________|_____________
                            True|                           |False
                                |                           |

        Decision Node -&gt; Is color == Yellow ?               Grape  &lt;- Leaf Node

                              |
                 _____________|_____________
            True|                           |False
                |                           |

Leaf Node -&gt;  Lemon                      Apple
</pre></div>
</div>
<ul class="simple">
<li><p>Decision Node will have</p>
<ul>
<li><p>a question</p></li>
<li><p>a true branch</p></li>
<li><p>a false branch</p></li>
<li><p>uncertainity value</p></li>
</ul>
</li>
<li><p>Leaf Node will have</p>
<ul>
<li><p>leaf value</p></li>
</ul>
</li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">class</span> <span class="nc">Node</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">question</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">true_branch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">false_branch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">uncertainty</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">leaf_value</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">question</span> <span class="o">=</span> <span class="n">question</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">true_branch</span> <span class="o">=</span> <span class="n">true_branch</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">false_branch</span> <span class="o">=</span> <span class="n">false_branch</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">uncertainty</span> <span class="o">=</span> <span class="n">uncertainty</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">leaf_value</span> <span class="o">=</span> <span class="n">leaf_value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_is_leaf_node</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">leaf_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

</pre></div>
</div>
</div>
</div>
<div class="section" id="Build-Tree">
<h2>Build Tree<a class="headerlink" href="#Build-Tree" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>start recursion</p>
<ul>
<li><p>find best split for the data (actually the question)</p></li>
<li><p>if gain == 0 then it is already a leaf node</p></li>
<li><p>else get paritition based on the question’s answer true_rows, false_rows</p></li>
<li><p>build tree from true_rows and false_true and get Decision node with question, left and right branch</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="Classification-Tree">
<h2>Classification Tree<a class="headerlink" href="#Classification-Tree" title="Permalink to this headline">¶</a></h2>
<div class="section" id="Gini-Impurity">
<h3>Gini Impurity<a class="headerlink" href="#Gini-Impurity" title="Permalink to this headline">¶</a></h3>
<p>Used by the CART (classification and regression tree) algorithm for classification trees, Gini impurity is a measure of how often a randomly chosen element from the set would be incorrectly labeled if it was randomly labeled according to the distribution of labels in the subset. The Gini impurity can be computed by summing the probability <span class="math notranslate nohighlight">\(p_{i}\)</span> of an item with label i being chosen times the probability</p>
<p><span class="math notranslate nohighlight">\(\sum_{k \neq i}{p_k} = 1 - {p_i}\)</span></p>
<p>of a mistake in categorizing that item. It reaches its minimum (zero) when all cases in the node fall into a single target category.</p>
<div class="math notranslate nohighlight">
\[{I_G(p)} = {\sum_{i=1}^{J}{(p_i\sum_{k \neq i}p_k)}} = {\sum_{i=1}^{J}p_i(1 - p_i)} = {\sum_{i=1}^{J}(p_i - p_i^2)} = {\sum_{i=1}^{J}p_i - \sum_{i=1}^{J}p_i^2} = { 1 - \sum_{i=1}^{J}p_i^2}\]</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">gini_impurity</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
    <span class="n">classes</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">gini_score</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">counts</span> <span class="o">/</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">gini_score</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">gini_impurity</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.4970414201183432
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">gini_impurity</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;apple&#39;</span><span class="p">,</span><span class="s1">&#39;apple&#39;</span><span class="p">,</span><span class="s1">&#39;apple&#39;</span><span class="p">,</span><span class="s1">&#39;apple&#39;</span><span class="p">])))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.0
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">gini_impurity</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;apple&#39;</span><span class="p">,</span><span class="s1">&#39;apple&#39;</span><span class="p">,</span><span class="s1">&#39;apple&#39;</span><span class="p">,</span><span class="s1">&#39;orange&#39;</span><span class="p">])))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.375
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">gini_impurity</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;apple&#39;</span><span class="p">,</span><span class="s1">&#39;apple&#39;</span><span class="p">,</span><span class="s1">&#39;apple&#39;</span><span class="p">,</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span><span class="s1">&#39;orange&#39;</span><span class="p">])))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.5
</pre></div></div>
</div>
</div>
<div class="section" id="Entropy">
<h3>Entropy<a class="headerlink" href="#Entropy" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>information theory concept to calculate uncertainity in the data</p></li>
</ul>
<p><span class="math notranslate nohighlight">\(H(T) = I_E(P) = - {\Sigma_{i=1}^{J}{p_i}log_2{p_i}}\)</span></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">entropy</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
    <span class="n">classes</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">counts</span> <span class="o">/</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">entropy_score</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">p</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">p</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">entropy_score</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">entropy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.9957274520849255
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">entropy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;apple&#39;</span><span class="p">,</span><span class="s1">&#39;apple&#39;</span><span class="p">,</span><span class="s1">&#39;apple&#39;</span><span class="p">,</span><span class="s1">&#39;apple&#39;</span><span class="p">])))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.0
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">entropy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;apple&#39;</span><span class="p">,</span><span class="s1">&#39;apple&#39;</span><span class="p">,</span><span class="s1">&#39;apple&#39;</span><span class="p">,</span><span class="s1">&#39;orange&#39;</span><span class="p">])))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.8112781244591328
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">entropy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;apple&#39;</span><span class="p">,</span><span class="s1">&#39;apple&#39;</span><span class="p">,</span><span class="s1">&#39;apple&#39;</span><span class="p">,</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span><span class="s1">&#39;orange&#39;</span><span class="p">])))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1.0
</pre></div></div>
</div>
</div>
<div class="section" id="Information-Gain">
<h3>Information Gain<a class="headerlink" href="#Information-Gain" title="Permalink to this headline">¶</a></h3>
<p>Information gain is the reduction in entropy or surprise by transforming a dataset and is often used in training decision trees. Information gain is calculated by comparing the entropy of the dataset before and after a transformation.</p>
<p>Inforgation Gain = H(Before splitting) - H(After splitting)</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">info_gain</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">parent_uncertainty</span><span class="p">):</span>

    <span class="n">pr</span> <span class="o">=</span> <span class="n">left</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">left</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">right</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="n">child_uncertainty</span> <span class="o">=</span> <span class="n">pr</span> <span class="o">*</span> \
        <span class="n">gini_impurity</span><span class="p">(</span><span class="n">left</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">pr</span><span class="p">)</span> <span class="o">*</span> <span class="n">gini_impurity</span><span class="p">(</span><span class="n">right</span><span class="p">)</span>

    <span class="n">info_gain_value</span> <span class="o">=</span> <span class="n">parent_uncertainty</span> <span class="o">-</span> <span class="n">child_uncertainty</span>
    <span class="k">return</span> <span class="n">info_gain_value</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">headers</span><span class="p">,</span><span class="n">dummy_train_data</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
([&#39;color&#39;, &#39;diameter&#39;, &#39;fruit&#39;],
 array([[&#39;Green&#39;, 3, &#39;Apple&#39;],
        [&#39;Red&#39;, 3, &#39;Apple&#39;],
        [&#39;Red&#39;, 1, &#39;Grape&#39;],
        [&#39;Red&#39;, 1, &#39;Grape&#39;],
        [&#39;Yellow&#39;, 3, &#39;Lemon&#39;]], dtype=object))
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">curr_uncert</span> <span class="o">=</span> <span class="n">gini_impurity</span><span class="p">(</span><span class="n">dummy_train_data</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">curr_uncert</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.6399999999999999
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ti</span> <span class="p">,</span> <span class="n">fi</span> <span class="o">=</span> <span class="n">partition</span><span class="p">(</span><span class="n">dummy_train_data</span><span class="p">,</span><span class="n">Question</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;Green&#39;</span><span class="p">,</span><span class="n">headers</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ts</span> <span class="o">=</span> <span class="n">dummy_train_data</span><span class="p">[</span><span class="n">ti</span><span class="p">,:]</span>
<span class="n">ts</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[&#39;Green&#39;, 3, &#39;Apple&#39;]], dtype=object)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fs</span> <span class="o">=</span> <span class="n">dummy_train_data</span><span class="p">[</span><span class="n">fi</span><span class="p">,:]</span>
<span class="n">fs</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[&#39;Red&#39;, 3, &#39;Apple&#39;],
       [&#39;Red&#39;, 1, &#39;Grape&#39;],
       [&#39;Red&#39;, 1, &#39;Grape&#39;],
       [&#39;Yellow&#39;, 3, &#39;Lemon&#39;]], dtype=object)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">info_gain</span><span class="p">(</span><span class="n">ts</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">fs</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">curr_uncert</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1.14
</pre></div></div>
</div>
</div>
<div class="section" id="Find-best-split-in-all-options">
<h3>Find best split in all options<a class="headerlink" href="#Find-best-split-in-all-options" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>based on the max information gain. find the best split</p></li>
<li><p>here based on the values of X, y is divided into true and false branch</p></li>
<li><p>before the split and after the split wherever we find maximum information gain we will take it as the best split</p></li>
<li><p>some artifacts like best question, best gain and parent_uncertainity are kept</p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">find_best_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">max_gain</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">best_split_question</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">parent_uncertainty</span> <span class="o">=</span> <span class="n">gini_impurity</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

    <span class="n">m_samples</span><span class="p">,</span> <span class="n">n_labels</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>

    <span class="k">for</span> <span class="n">col_index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_labels</span><span class="p">):</span>  <span class="c1"># iterate over feature columns</span>
        <span class="c1"># get unique values from the feature</span>
        <span class="n">unique_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="n">col_index</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">unique_values</span><span class="p">:</span>  <span class="c1"># check for every value and find maximum info gain</span>

            <span class="n">ques</span> <span class="o">=</span> <span class="n">Question</span><span class="p">(</span>
                <span class="n">column_index</span><span class="o">=</span><span class="n">col_index</span><span class="p">,</span>
                <span class="n">value</span><span class="o">=</span><span class="n">val</span><span class="p">,</span>
                <span class="n">header</span><span class="o">=</span><span class="n">headers</span><span class="p">[</span><span class="n">col_index</span><span class="p">]</span>
            <span class="p">)</span>

            <span class="n">t_idx</span><span class="p">,</span> <span class="n">f_idx</span> <span class="o">=</span> <span class="n">partition</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">ques</span><span class="p">)</span>
            <span class="c1"># if it does not split the data</span>
            <span class="c1"># skip it</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">t_idx</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">f_idx</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="n">true_y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">t_idx</span><span class="p">,</span> <span class="p">:]</span>
            <span class="n">false_y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">f_idx</span><span class="p">,</span> <span class="p">:]</span>

            <span class="n">gain</span> <span class="o">=</span> <span class="n">info_gain</span><span class="p">(</span><span class="n">true_y</span><span class="p">,</span> <span class="n">false_y</span><span class="p">,</span> <span class="n">parent_uncertainty</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">gain</span> <span class="o">&gt;</span> <span class="n">max_gain</span><span class="p">:</span>
                <span class="n">max_gain</span><span class="p">,</span> <span class="n">best_split_question</span> <span class="o">=</span> <span class="n">gain</span><span class="p">,</span> <span class="n">ques</span>

    <span class="k">return</span> <span class="n">max_gain</span><span class="p">,</span> <span class="n">best_split_question</span><span class="p">,</span> <span class="n">parent_uncertainty</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">find_best_split</span><span class="p">(</span><span class="n">dummy_train_data</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">dummy_train_data</span><span class="p">[:,[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1.14, Is color == Green ?, 0.6399999999999999)
</pre></div></div>
</div>
</div>
<div class="section" id="Classification/-Prediction">
<h3>Classification/ Prediction<a class="headerlink" href="#Classification/-Prediction" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>traverse the tree and use the question to match and classify</p></li>
</ul>
</div>
<div class="section" id="Creating-a-Classification-Model">
<h3>Creating a Classification Model<a class="headerlink" href="#Creating-a-Classification-Model" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>


<span class="k">class</span> <span class="nc">Node</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">question</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">true_branch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">false_branch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">uncertainty</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">leaf_value</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">question</span> <span class="o">=</span> <span class="n">question</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">true_branch</span> <span class="o">=</span> <span class="n">true_branch</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">false_branch</span> <span class="o">=</span> <span class="n">false_branch</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">uncertainty</span> <span class="o">=</span> <span class="n">uncertainty</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">leaf_value</span> <span class="o">=</span> <span class="n">leaf_value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_is_leaf_node</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">leaf_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>


<span class="k">class</span> <span class="nc">Question</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column_index</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">header</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">column_index</span> <span class="o">=</span> <span class="n">column_index</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">header</span> <span class="o">=</span> <span class="n">header</span>

    <span class="k">def</span> <span class="nf">match</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">example</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">example</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">example</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">example</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;O&quot;</span><span class="p">)</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">example</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">column_index</span><span class="p">]</span>

        <span class="c1"># adding numpy int and float data types as well</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)):</span>
            <span class="c1"># a condition for question to return True or False for numeric value</span>
            <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>  <span class="c1"># categorical data comparison</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="s2">&quot;==&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)):</span>
            <span class="n">condition</span> <span class="o">=</span> <span class="s2">&quot;&gt;=&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Is </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">condition</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2"> ?&quot;</span>


<span class="k">class</span> <span class="nc">DecisionTreeClassifier</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">min_samples_split</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">criteria</span><span class="o">=</span><span class="s1">&#39;gini&#39;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_X</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_feature_names</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_target_name</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tree</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_depth</span> <span class="o">=</span> <span class="n">max_depth</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_samples_split</span> <span class="o">=</span> <span class="n">min_samples_split</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span> <span class="o">=</span> <span class="n">criteria</span>

    <span class="k">def</span> <span class="nf">_count_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="n">unique_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">zipped</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">unique_values</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">zipped</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_gini_impurity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arr</span><span class="p">):</span>
        <span class="n">classes</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">gini_score</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">counts</span> <span class="o">/</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">gini_score</span>

    <span class="k">def</span> <span class="nf">_entropy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arr</span><span class="p">):</span>
        <span class="n">classes</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">counts</span> <span class="o">/</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">entropy_score</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">p</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">p</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">entropy_score</span>

    <span class="k">def</span> <span class="nf">_partition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rows</span><span class="p">,</span> <span class="n">question</span><span class="p">):</span>
        <span class="n">true_idx</span><span class="p">,</span> <span class="n">false_idx</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">question</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
                <span class="n">true_idx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">false_idx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">true_idx</span><span class="p">,</span> <span class="n">false_idx</span>

    <span class="k">def</span> <span class="nf">_info_gain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">parent_uncertainty</span><span class="p">):</span>

        <span class="n">pr</span> <span class="o">=</span> <span class="n">left</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">left</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">right</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span> <span class="o">==</span> <span class="s2">&quot;entropy&quot;</span><span class="p">:</span>
            <span class="n">child_uncertainty</span> <span class="o">=</span> <span class="n">pr</span> <span class="o">*</span> \
                <span class="bp">self</span><span class="o">.</span><span class="n">_entropy</span><span class="p">(</span><span class="n">left</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">pr</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_entropy</span><span class="p">(</span><span class="n">right</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">child_uncertainty</span> <span class="o">=</span> <span class="n">pr</span> <span class="o">*</span> \
                <span class="bp">self</span><span class="o">.</span><span class="n">_gini_impurity</span><span class="p">(</span><span class="n">left</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">pr</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gini_impurity</span><span class="p">(</span><span class="n">right</span><span class="p">)</span>

        <span class="n">info_gain_value</span> <span class="o">=</span> <span class="n">parent_uncertainty</span> <span class="o">-</span> <span class="n">child_uncertainty</span>
        <span class="k">return</span> <span class="n">info_gain_value</span>

    <span class="k">def</span> <span class="nf">_find_best_split</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>

        <span class="n">max_gain</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">best_split_question</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span> <span class="o">==</span> <span class="s2">&quot;entropy&quot;</span><span class="p">:</span>
            <span class="n">parent_uncertainty</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_entropy</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">parent_uncertainty</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gini_impurity</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

        <span class="n">m_samples</span><span class="p">,</span> <span class="n">n_labels</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>

        <span class="k">for</span> <span class="n">col_index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_labels</span><span class="p">):</span>  <span class="c1"># iterate over feature columns</span>
            <span class="c1"># get unique values from the feature</span>
            <span class="n">unique_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="n">col_index</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">unique_values</span><span class="p">:</span>  <span class="c1"># check for every value and find maximum info gain</span>

                <span class="n">ques</span> <span class="o">=</span> <span class="n">Question</span><span class="p">(</span>
                    <span class="n">column_index</span><span class="o">=</span><span class="n">col_index</span><span class="p">,</span>
                    <span class="n">value</span><span class="o">=</span><span class="n">val</span><span class="p">,</span>
                    <span class="n">header</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_feature_names</span><span class="p">[</span><span class="n">col_index</span><span class="p">]</span>
                <span class="p">)</span>

                <span class="n">t_idx</span><span class="p">,</span> <span class="n">f_idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_partition</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">ques</span><span class="p">)</span>
                <span class="c1"># if it does not split the data</span>
                <span class="c1"># skip it</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">t_idx</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">f_idx</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="n">true_y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">t_idx</span><span class="p">,</span> <span class="p">:]</span>
                <span class="n">false_y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">f_idx</span><span class="p">,</span> <span class="p">:]</span>

                <span class="n">gain</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_info_gain</span><span class="p">(</span><span class="n">true_y</span><span class="p">,</span> <span class="n">false_y</span><span class="p">,</span> <span class="n">parent_uncertainty</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">gain</span> <span class="o">&gt;</span> <span class="n">max_gain</span><span class="p">:</span>
                    <span class="n">max_gain</span><span class="p">,</span> <span class="n">best_split_question</span> <span class="o">=</span> <span class="n">gain</span><span class="p">,</span> <span class="n">ques</span>

        <span class="k">return</span> <span class="n">max_gain</span><span class="p">,</span> <span class="n">best_split_question</span><span class="p">,</span> <span class="n">parent_uncertainty</span>

    <span class="k">def</span> <span class="nf">_build_tree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="n">m_samples</span><span class="p">,</span> <span class="n">n_labels</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">depth</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_depth</span> <span class="ow">or</span> <span class="n">n_labels</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">m_samples</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_samples_split</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">Node</span><span class="p">(</span><span class="n">leaf_value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_count_dict</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>

        <span class="n">gain</span><span class="p">,</span> <span class="n">ques</span><span class="p">,</span> <span class="n">uncertainty</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_best_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">gain</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Node</span><span class="p">(</span><span class="n">leaf_value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_count_dict</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>

        <span class="n">t_idx</span><span class="p">,</span> <span class="n">f_idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_partition</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">ques</span><span class="p">)</span>
        <span class="n">true_branch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_tree</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">t_idx</span><span class="p">,</span> <span class="p">:],</span> <span class="n">y</span><span class="p">[</span><span class="n">t_idx</span><span class="p">,</span> <span class="p">:],</span> <span class="n">depth</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">false_branch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_tree</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">f_idx</span><span class="p">,</span> <span class="p">:],</span> <span class="n">y</span><span class="p">[</span><span class="n">f_idx</span><span class="p">,</span> <span class="p">:],</span> <span class="n">depth</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Node</span><span class="p">(</span>
            <span class="n">question</span><span class="o">=</span><span class="n">ques</span><span class="p">,</span>
            <span class="n">true_branch</span><span class="o">=</span><span class="n">true_branch</span><span class="p">,</span>
            <span class="n">false_branch</span><span class="o">=</span><span class="n">false_branch</span><span class="p">,</span>
            <span class="n">uncertainty</span><span class="o">=</span><span class="n">uncertainty</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">feature_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">target_name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;O&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">))</span> <span class="k">else</span> <span class="n">X</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;O&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">))</span> <span class="k">else</span> <span class="n">y</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">X</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">y</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_feature_names</span> <span class="o">=</span> <span class="n">feature_name</span> <span class="ow">or</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;C_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_target_name</span> <span class="o">=</span> <span class="n">target_name</span> <span class="ow">or</span> <span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_tree</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_tree</span><span class="p">(</span>
            <span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_X</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_y</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">print_tree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">spacing</span><span class="o">=</span><span class="s2">&quot;|-&quot;</span><span class="p">):</span>

        <span class="n">node</span> <span class="o">=</span> <span class="n">node</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tree</span>

        <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">_is_leaf_node</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">spacing</span><span class="p">,</span> <span class="s2">&quot; Predict :&quot;</span><span class="p">,</span> <span class="n">node</span><span class="o">.</span><span class="n">leaf_value</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="c1"># Print the question at this node</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">spacing</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">question</span><span class="p">)</span> <span class="o">+</span>
              <span class="s2">&quot; | &quot;</span><span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span> <span class="o">+</span><span class="s2">&quot; :&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">uncertainty</span><span class="p">))</span>

        <span class="c1"># Call this function recursively on the true branch</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">spacing</span> <span class="o">+</span> <span class="s1">&#39;--&gt; True:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">print_tree</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">true_branch</span><span class="p">,</span> <span class="s2">&quot;  &quot;</span> <span class="o">+</span> <span class="n">spacing</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span>

        <span class="c1"># Call this function recursively on the false branch</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">spacing</span> <span class="o">+</span> <span class="s1">&#39;--&gt; False:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">print_tree</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">false_branch</span><span class="p">,</span> <span class="s2">&quot;  &quot;</span> <span class="o">+</span> <span class="n">spacing</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_classification</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">_is_leaf_node</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">node</span><span class="o">.</span><span class="n">leaf_value</span>

        <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">question</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_classification</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">node</span><span class="o">.</span><span class="n">true_branch</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_classification</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">node</span><span class="o">.</span><span class="n">false_branch</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_print_leaf_probability</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">results</span><span class="p">):</span>
        <span class="n">total</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="n">probs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
            <span class="n">probs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">/</span> <span class="n">total</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
        <span class="k">return</span> <span class="n">probs</span>

    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
            <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;O&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">))</span> <span class="k">else</span> <span class="n">X</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_classification</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">node</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_tree</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">leaf_value</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">X</span><span class="p">:</span>
                    <span class="n">max_result</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="n">result_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_classification</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span> <span class="n">node</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_tree</span><span class="p">)</span>
                    <span class="n">result</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">result_dict</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">result_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">max_result</span><span class="p">:</span>
                            <span class="n">result</span> <span class="o">=</span> <span class="n">key</span>
                    <span class="n">leaf_value</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">result</span><span class="p">])</span>
                <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">leaf_value</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;O&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;X should be list or numpy array&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">predict_probability</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
            <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;O&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">))</span> <span class="k">else</span> <span class="n">X</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print_leaf_probability</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_classification</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">node</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_tree</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">leaf_value</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">X</span><span class="p">:</span>
                    <span class="n">leaf_value</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_print_leaf_probability</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_classification</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span> <span class="n">node</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_tree</span><span class="p">))])</span>
                <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">leaf_value</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;O&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;X should be list or numpy array&quot;</span><span class="p">)</span>

</pre></div>
</div>
</div>
</div>
<div class="section" id="Testing-with-Data">
<h3>Testing with Data<a class="headerlink" href="#Testing-with-Data" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_iris</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">()</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">data</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">target</span>
<span class="n">feature_name</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">feature_names</span>
<span class="n">X_train</span><span class="p">,</span><span class="n">X_test</span><span class="p">,</span><span class="n">y_train</span><span class="p">,</span><span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span><span class="n">test_size</span><span class="o">=</span><span class="mf">0.10</span><span class="p">)</span>

<span class="n">dt</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">min_samples_split</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">dt</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X_train</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span><span class="n">feature_name</span><span class="o">=</span><span class="n">feature_name</span><span class="p">)</span>

<span class="n">dt</span><span class="o">.</span><span class="n">print_tree</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
|-Is sepal length (cm) &gt;= 7.9 ? | gini :0.6663374485596707
|---&gt; True:
  |--  Predict : {2: 1}
|---&gt; False:
  |--Is sepal width (cm) &gt;= 4.4 ? | gini :0.6665181554912007
  |----&gt; True:
    |---  Predict : {0: 1}
  |----&gt; False:
    |---Is sepal width (cm) &gt;= 4.2 ? | gini :0.666402849228334
    |-----&gt; True:
      |----  Predict : {0: 1}
    |-----&gt; False:
      |----Is sepal width (cm) &gt;= 4.1 ? | gini :0.6662075298438934
      |------&gt; True:
        |-----  Predict : {0: 1}
      |------&gt; False:
        |-----Is sepal width (cm) &gt;= 4.0 ? | gini :0.6659285589417866
        |-------&gt; True:
          |------  Predict : {0: 1}
        |-------&gt; False:
          |------Is petal length (cm) &gt;= 6.7 ? | gini :0.6655621301775148
          |--------&gt; True:
            |-------  Predict : {2: 2}
          |--------&gt; False:
            |-------Is sepal length (cm) &gt;= 7.7 ? | gini :0.666015625
            |---------&gt; True:
              |--------  Predict : {2: 1}
            |---------&gt; False:
              |--------Is sepal length (cm) &gt;= 7.6 ? | gini :0.6661293322586646
              |----------&gt; True:
                |---------  Predict : {2: 1}
              |----------&gt; False:
                |---------Is sepal length (cm) &gt;= 7.4 ? | gini :0.6661627614008567
                |-----------&gt; True:
                  |----------  Predict : {2: 1}
                |-----------&gt; False:
                  |----------Is sepal length (cm) &gt;= 7.3 ? | gini :0.666112
                  |------------&gt; True:
                    |-----------  Predict : {2: 1}
                  |------------&gt; False:
                    |-----------Is petal length (cm) &gt;= 6.1 ? | gini :0.6659729448491154
                    |-------------&gt; True:
                      |------------  Predict : {2: 1}
                    |-------------&gt; False:
                      |------------Is sepal width (cm) &gt;= 3.9 ? | gini :0.6657412915592571
                      |--------------&gt; True:
                        |-------------  Predict : {0: 2}
                      |--------------&gt; False:
                        |-------------Is sepal length (cm) &gt;= 7.2 ? | gini :0.6652551055255789
                        |---------------&gt; True:
                          |--------------  Predict : {2: 2}
                        |---------------&gt; False:
                          |--------------Is sepal length (cm) &gt;= 7.1 ? | gini :0.664642327519243
                          |----------------&gt; True:
                            |---------------  Predict : {2: 1}
                          |----------------&gt; False:
                            |---------------Is sepal length (cm) &gt;= 7.0 ? | gini :0.6641769606434933
                            |-----------------&gt; True:
                              |----------------  Predict : {1: 1}
                            |-----------------&gt; False:
                              |----------------Is petal length (cm) &gt;= 6.0 ? | gini :0.664767331433998
                              |------------------&gt; True:
                                |-----------------  Predict : {2: 1}
                              |------------------&gt; False:
                                |-----------------Is petal length (cm) &gt;= 5.9 ? | gini :0.6642390011890607
                                |-------------------&gt; True:
                                  |------------------  Predict : {2: 1}
                                |-------------------&gt; False:
                                  |------------------Is petal width (cm) &gt;= 2.5 ? | gini :0.6635916824196597
                                  |--------------------&gt; True:
                                    |-------------------  Predict : {2: 1}
                                  |--------------------&gt; False:
                                    |-------------------Is sepal width (cm) &gt;= 3.8 ? | gini :0.6628193290243152
                                    |---------------------&gt; True:
                                      |--------------------  Predict : {0: 2}
                                    |---------------------&gt; False:
                                      |--------------------Is petal length (cm) &gt;= 5.8 ? | gini :0.6624681122448979
                                      |----------------------&gt; True:
                                        |---------------------  Predict : {2: 2}
                                      |----------------------&gt; False:
                                        |---------------------Is petal length (cm) &gt;= 5.7 ? | gini :0.6606611570247933
                                        |-----------------------&gt; True:
                                          |----------------------  Predict : {2: 2}
                                        |-----------------------&gt; False:
                                          |----------------------Is sepal width (cm) &gt;= 3.7 ? | gini :0.6582647462277091
                                          |------------------------&gt; True:
                                            |-----------------------  Predict : {0: 3}
                                          |------------------------&gt; False:
                                            |-----------------------Is sepal width (cm) &gt;= 3.6 ? | gini :0.657233560090703
                                            |-------------------------&gt; True:
                                              |------------------------  Predict : {0: 3}
                                            |-------------------------&gt; False:
                                              |------------------------Is sepal length (cm) &gt;= 6.9 ? | gini :0.6549404075355633
                                              |--------------------------&gt; True:
                                                |-------------------------  Predict : {1: 1, 2: 1}
                                              |--------------------------&gt; False:
                                                |-------------------------Is sepal length (cm) &gt;= 6.8 ? | gini :0.6552
                                                |---------------------------&gt; True:
                                                  |--------------------------  Predict : {2: 1}
                                                |---------------------------&gt; False:
                                                  |--------------------------Is petal width (cm) &gt;= 2.4 ? | gini :0.6538108356290174
                                                  |----------------------------&gt; True:
                                                    |---------------------------  Predict : {2: 3}
                                                  |----------------------------&gt; False:
                                                    |---------------------------Is petal width (cm) &gt;= 2.3 ? | gini :0.6484375
                                                    |-----------------------------&gt; True:
                                                      |----------------------------  Predict : {2: 3}
                                                    |-----------------------------&gt; False:
                                                      |----------------------------Is petal width (cm) &gt;= 2.2 ? | gini :0.6409989594172737
                                                      |------------------------------&gt; True:
                                                        |-----------------------------  Predict : {2: 1}
                                                      |------------------------------&gt; False:
                                                        |-----------------------------Is petal width (cm) &gt;= 2.1 ? | gini :0.6379962192816635
                                                        |-------------------------------&gt; True:
                                                          |------------------------------  Predict : {2: 1}
                                                        |-------------------------------&gt; False:
                                                          |------------------------------Is sepal length (cm) &gt;= 6.7 ? | gini :0.6347059533872721
                                                          |--------------------------------&gt; True:
                                                            |-------------------------------  Predict : {1: 3}
                                                          |--------------------------------&gt; False:
                                                            |-------------------------------Is sepal length (cm) &gt;= 6.6 ? | gini :0.640754132231405
                                                            |---------------------------------&gt; True:
                                                              |--------------------------------  Predict : {1: 2}
                                                            |---------------------------------&gt; False:
                                                              |--------------------------------Is petal length (cm) &gt;= 5.6 ? | gini :0.6444023796646836
                                                              |----------------------------------&gt; True:
                                                                |---------------------------------  Predict : {2: 2}
                                                              |----------------------------------&gt; False:
                                                                |---------------------------------Is petal length (cm) &gt;= 5.5 ? | gini :0.6374716553287982
                                                                |-----------------------------------&gt; True:
                                                                  |----------------------------------  Predict : {2: 2}
                                                                |-----------------------------------&gt; False:
                                                                  |----------------------------------Is petal length (cm) &gt;= 5.3 ? | gini :0.6290898274836407
                                                                  |------------------------------------&gt; True:
                                                                    |-----------------------------------  Predict : {2: 1}
                                                                  |------------------------------------&gt; False:
                                                                    |-----------------------------------Is petal length (cm) &gt;= 5.2 ? | gini :0.6242950769699742
                                                                    |-------------------------------------&gt; True:
                                                                      |------------------------------------  Predict : {2: 1}
                                                                    |-------------------------------------&gt; False:
                                                                      |------------------------------------Is sepal length (cm) &gt;= 6.5 ? | gini :0.6190625
                                                                      |--------------------------------------&gt; True:
                                                                        |-------------------------------------  Predict : {1: 1}
                                                                      |--------------------------------------&gt; False:
                                                                        |-------------------------------------Is sepal length (cm) &gt;= 6.4 ? | gini :0.6210543182182342
                                                                        |---------------------------------------&gt; True:
                                                                          |--------------------------------------  Predict : {1: 2}
                                                                        |---------------------------------------&gt; False:
                                                                          |--------------------------------------Is petal width (cm) &gt;= 2.0 ? | gini :0.6247259234272221
                                                                          |----------------------------------------&gt; True:
                                                                            |---------------------------------------  Predict : {2: 2}
                                                                          |----------------------------------------&gt; False:
                                                                            |---------------------------------------Is sepal width (cm) &gt;= 3.5 ? | gini :0.6129777777777778
                                                                            |-----------------------------------------&gt; True:
                                                                              |----------------------------------------  Predict : {0: 5}
                                                                            |-----------------------------------------&gt; False:
                                                                              |----------------------------------------Is petal width (cm) &gt;= 1.9 ? | gini :0.6118367346938776
                                                                              |------------------------------------------&gt; True:
                                                                                |-----------------------------------------  Predict : {2: 3}
                                                                              |------------------------------------------&gt; False:
                                                                                |-----------------------------------------Is petal length (cm) &gt;= 5.1 ? | gini :0.5889953218979729
                                                                                |-------------------------------------------&gt; True:
                                                                                  |------------------------------------------  Predict : {1: 1, 2: 2}
                                                                                |-------------------------------------------&gt; False:
                                                                                  |------------------------------------------Is petal length (cm) &gt;= 5.0 ? | gini :0.57275390625
                                                                                  |--------------------------------------------&gt; True:
                                                                                    |-------------------------------------------  Predict : {2: 1}
                                                                                  |--------------------------------------------&gt; False:
                                                                                    |-------------------------------------------Is sepal length (cm) &gt;= 6.3 ? | gini :0.561854371378181
                                                                                    |---------------------------------------------&gt; True:
                                                                                      |--------------------------------------------  Predict : {1: 3, 2: 1}
                                                                                    |---------------------------------------------&gt; False:
                                                                                      |--------------------------------------------Is petal length (cm) &gt;= 4.9 ? | gini :0.5573111174949728
                                                                                      |----------------------------------------------&gt; True:
                                                                                        |---------------------------------------------  Predict : {2: 1}
                                                                                      |----------------------------------------------&gt; False:
                                                                                        |---------------------------------------------Is sepal length (cm) &gt;= 6.2 ? | gini :0.5439952437574316
                                                                                        |-----------------------------------------------&gt; True:
                                                                                          |----------------------------------------------  Predict : {1: 1, 2: 1}
                                                                                        |-----------------------------------------------&gt; False:
                                                                                          |----------------------------------------------Is sepal length (cm) &gt;= 6.1 ? | gini :0.53125
                                                                                          |------------------------------------------------&gt; True:
                                                                                            |-----------------------------------------------  Predict : {1: 3}
                                                                                          |------------------------------------------------&gt; False:
                                                                                            |-----------------------------------------------Is petal length (cm) &gt;= 4.8 ? | gini :0.5354218583125667
                                                                                            |-------------------------------------------------&gt; True:
                                                                                              |------------------------------------------------  Predict : {1: 1, 2: 1}
                                                                                            |-------------------------------------------------&gt; False:
                                                                                              |------------------------------------------------Is sepal length (cm) &gt;= 6.0 ? | gini :0.5190311418685121
                                                                                              |--------------------------------------------------&gt; True:
                                                                                                |-------------------------------------------------  Predict : {1: 2}
                                                                                              |--------------------------------------------------&gt; False:
                                                                                                |-------------------------------------------------Is sepal length (cm) &gt;= 5.9 ? | gini :0.5189504373177842
                                                                                                |---------------------------------------------------&gt; True:
                                                                                                  |--------------------------------------------------  Predict : {1: 1}
                                                                                                |---------------------------------------------------&gt; False:
                                                                                                  |--------------------------------------------------Is sepal length (cm) &gt;= 5.8 ? | gini :0.5182291666666666
                                                                                                  |----------------------------------------------------&gt; True:
                                                                                                    |---------------------------------------------------  Predict : {1: 2}
                                                                                                  |----------------------------------------------------&gt; False:
                                                                                                    |---------------------------------------------------Is petal width (cm) &gt;= 1.7 ? | gini :0.5151228733459357
                                                                                                    |-----------------------------------------------------&gt; True:
                                                                                                      |----------------------------------------------------  Predict : {2: 1}
                                                                                                    |-----------------------------------------------------&gt; False:
                                                                                                      |----------------------------------------------------Is petal width (cm) &gt;= 1.5 ? | gini :0.49382716049382713
                                                                                                      |------------------------------------------------------&gt; True:
                                                                                                        |-----------------------------------------------------  Predict : {1: 2}
                                                                                                      |------------------------------------------------------&gt; False:
                                                                                                        |-----------------------------------------------------Is petal length (cm) &gt;= 4.5 ? | gini :0.48674959437533794
                                                                                                        |-------------------------------------------------------&gt; True:
                                                                                                          |------------------------------------------------------  Predict : {1: 1}
                                                                                                        |-------------------------------------------------------&gt; False:
                                                                                                          |------------------------------------------------------Is petal length (cm) &gt;= 4.4 ? | gini :0.481859410430839
                                                                                                          |--------------------------------------------------------&gt; True:
                                                                                                            |-------------------------------------------------------  Predict : {1: 1}
                                                                                                          |--------------------------------------------------------&gt; False:
                                                                                                            |-------------------------------------------------------Is petal width (cm) &gt;= 1.4 ? | gini :0.47590719809637116
                                                                                                            |---------------------------------------------------------&gt; True:
                                                                                                              |--------------------------------------------------------  Predict : {1: 1}
                                                                                                            |---------------------------------------------------------&gt; False:
                                                                                                              |--------------------------------------------------------Is petal length (cm) &gt;= 4.2 ? | gini :0.46875
                                                                                                              |----------------------------------------------------------&gt; True:
                                                                                                                |---------------------------------------------------------  Predict : {1: 3}
                                                                                                              |----------------------------------------------------------&gt; False:
                                                                                                                |---------------------------------------------------------Is sepal length (cm) &gt;= 5.7 ? | gini :0.43827611395178967
                                                                                                                |-----------------------------------------------------------&gt; True:
                                                                                                                  |----------------------------------------------------------  Predict : {1: 2}
                                                                                                                |-----------------------------------------------------------&gt; False:
                                                                                                                  |----------------------------------------------------------Is petal length (cm) &gt;= 4.1 ? | gini :0.40816326530612246
                                                                                                                  |------------------------------------------------------------&gt; True:
                                                                                                                    |-----------------------------------------------------------  Predict : {1: 1}
                                                                                                                  |------------------------------------------------------------&gt; False:
                                                                                                                    |-----------------------------------------------------------Is sepal length (cm) &gt;= 5.6 ? | gini :0.38927335640138394
                                                                                                                    |-------------------------------------------------------------&gt; True:
                                                                                                                      |------------------------------------------------------------  Predict : {1: 1}
                                                                                                                    |-------------------------------------------------------------&gt; False:
                                                                                                                      |------------------------------------------------------------Is sepal width (cm) &gt;= 3.4 ? | gini :0.3673094582185492
                                                                                                                      |--------------------------------------------------------------&gt; True:
                                                                                                                        |-------------------------------------------------------------  Predict : {0: 8}
                                                                                                                      |--------------------------------------------------------------&gt; False:
                                                                                                                        |-------------------------------------------------------------Is sepal width (cm) &gt;= 3.3 ? | gini :0.4351999999999999
                                                                                                                        |---------------------------------------------------------------&gt; True:
                                                                                                                          |--------------------------------------------------------------  Predict : {0: 2}
                                                                                                                        |---------------------------------------------------------------&gt; False:
                                                                                                                          |--------------------------------------------------------------Is sepal width (cm) &gt;= 3.2 ? | gini :0.45368620037807184
                                                                                                                          |----------------------------------------------------------------&gt; True:
                                                                                                                            |---------------------------------------------------------------  Predict : {0: 5}
                                                                                                                          |----------------------------------------------------------------&gt; False:
                                                                                                                            |---------------------------------------------------------------Is petal length (cm) &gt;= 4.0 ? | gini :0.49382716049382713
                                                                                                                            |-----------------------------------------------------------------&gt; True:
                                                                                                                              |----------------------------------------------------------------  Predict : {1: 2}
                                                                                                                            |-----------------------------------------------------------------&gt; False:
                                                                                                                              |----------------------------------------------------------------Is petal length (cm) &gt;= 3.8 ? | gini :0.46875
                                                                                                                              |------------------------------------------------------------------&gt; True:
                                                                                                                                |-----------------------------------------------------------------  Predict : {1: 1}
                                                                                                                              |------------------------------------------------------------------&gt; False:
                                                                                                                                |-----------------------------------------------------------------Is sepal width (cm) &gt;= 3.1 ? | gini :0.4444444444444444
                                                                                                                                |-------------------------------------------------------------------&gt; True:
                                                                                                                                  |------------------------------------------------------------------  Predict : {0: 3}
                                                                                                                                |-------------------------------------------------------------------&gt; False:
                                                                                                                                  |------------------------------------------------------------------Is sepal length (cm) &gt;= 5.5 ? | gini :0.48611111111111105
                                                                                                                                  |--------------------------------------------------------------------&gt; True:
                                                                                                                                    |-------------------------------------------------------------------  Predict : {1: 1}
                                                                                                                                  |--------------------------------------------------------------------&gt; False:
                                                                                                                                    |-------------------------------------------------------------------Is sepal length (cm) &gt;= 5.1 ? | gini :0.4628099173553719
                                                                                                                                    |---------------------------------------------------------------------&gt; True:
                                                                                                                                      |--------------------------------------------------------------------  Predict : {1: 1}
                                                                                                                                    |---------------------------------------------------------------------&gt; False:
                                                                                                                                      |--------------------------------------------------------------------Is petal length (cm) &gt;= 3.5 ? | gini :0.42000000000000004
                                                                                                                                      |----------------------------------------------------------------------&gt; True:
                                                                                                                                        |---------------------------------------------------------------------  Predict : {1: 1}
                                                                                                                                      |----------------------------------------------------------------------&gt; False:
                                                                                                                                        |---------------------------------------------------------------------  Predict : {0: 7, 1: 2}
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">y_pred</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>


<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">y_test</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">y_pred</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;original&#39;</span><span class="p">,</span><span class="s1">&#39;predicted&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>original</th>
      <th>predicted</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>11</th>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>12</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">y_pred</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">predict_probability</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">y_test</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">y_pred</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;original&#39;</span><span class="p">,</span><span class="s1">&#39;predicted&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>original</th>
      <th>predicted</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>{1: 100.0}</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>{0: 100.0}</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>{2: 100.0}</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>{1: 100.0}</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>{2: 100.0}</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0</td>
      <td>{0: 100.0}</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1</td>
      <td>{1: 100.0}</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2</td>
      <td>{1: 50.0, 2: 50.0}</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1</td>
      <td>{1: 50.0, 2: 50.0}</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1</td>
      <td>{1: 100.0}</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2</td>
      <td>{1: 100.0}</td>
    </tr>
    <tr>
      <th>11</th>
      <td>0</td>
      <td>{0: 77.77777777777779, 1: 22.22222222222222}</td>
    </tr>
    <tr>
      <th>12</th>
      <td>0</td>
      <td>{0: 100.0}</td>
    </tr>
    <tr>
      <th>13</th>
      <td>0</td>
      <td>{0: 100.0}</td>
    </tr>
    <tr>
      <th>14</th>
      <td>0</td>
      <td>{0: 100.0}</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_iris</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">()</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">data</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">target</span>
<span class="n">feature_name</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">feature_names</span>
<span class="n">X_train</span><span class="p">,</span><span class="n">X_test</span><span class="p">,</span><span class="n">y_train</span><span class="p">,</span><span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span><span class="n">test_size</span><span class="o">=</span><span class="mf">0.10</span><span class="p">)</span>

<span class="n">dt</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">criteria</span><span class="o">=</span><span class="s1">&#39;entropy&#39;</span><span class="p">)</span>
<span class="n">dt</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X_train</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span><span class="n">feature_name</span><span class="o">=</span><span class="n">feature_name</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">predict_probability</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">y_test</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">y_pred</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;original&#39;</span><span class="p">,</span><span class="s1">&#39;predicted&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>original</th>
      <th>predicted</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>{1: 100.0}</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>{0: 100.0}</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>{2: 100.0}</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>{1: 100.0}</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>{2: 100.0}</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0</td>
      <td>{0: 100.0}</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1</td>
      <td>{1: 100.0}</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2</td>
      <td>{1: 100.0}</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1</td>
      <td>{2: 100.0}</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1</td>
      <td>{1: 100.0}</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2</td>
      <td>{1: 100.0}</td>
    </tr>
    <tr>
      <th>11</th>
      <td>0</td>
      <td>{0: 100.0}</td>
    </tr>
    <tr>
      <th>12</th>
      <td>0</td>
      <td>{0: 100.0}</td>
    </tr>
    <tr>
      <th>13</th>
      <td>0</td>
      <td>{0: 100.0}</td>
    </tr>
    <tr>
      <th>14</th>
      <td>0</td>
      <td>{0: 100.0}</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</div>
</div>
<div class="section" id="Regression-Tree">
<h2>Regression Tree<a class="headerlink" href="#Regression-Tree" title="Permalink to this headline">¶</a></h2>
<div class="section" id="Variance-Reduction">
<h3>Variance Reduction<a class="headerlink" href="#Variance-Reduction" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>similar to classification we need an information gain medium before and after splitting node.</p></li>
<li><p>here variance of parent is subtracted from variance of child components(pr(percentage weight) * var).</p></li>
</ul>
</div>
<div class="section" id="id1">
<h3>Find best split in all options<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>based on the max information gain. find the best split</p></li>
<li><p>here based on the values of X, y is divided into true and false branch</p></li>
<li><p>before the split and after the split wherever we find maximum information gain we will take it as the best split</p></li>
<li><p>some artifacts like best question, best gain and parent_uncertainity are kept</p></li>
</ul>
</div>
<div class="section" id="Creating-a-Regression-Model">
<h3>Creating a Regression Model<a class="headerlink" href="#Creating-a-Regression-Model" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>


<span class="k">class</span> <span class="nc">Node</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">question</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">true_branch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">false_branch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">uncertainty</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">leaf_value</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">question</span> <span class="o">=</span> <span class="n">question</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">true_branch</span> <span class="o">=</span> <span class="n">true_branch</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">false_branch</span> <span class="o">=</span> <span class="n">false_branch</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">uncertainty</span> <span class="o">=</span> <span class="n">uncertainty</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">leaf_value</span> <span class="o">=</span> <span class="n">leaf_value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_is_leaf_node</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">leaf_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>


<span class="k">class</span> <span class="nc">Question</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column_index</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">header</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">column_index</span> <span class="o">=</span> <span class="n">column_index</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">header</span> <span class="o">=</span> <span class="n">header</span>

    <span class="k">def</span> <span class="nf">match</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">example</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">example</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">example</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">example</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;O&quot;</span><span class="p">)</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">example</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">column_index</span><span class="p">]</span>

        <span class="c1"># adding numpy int and float data types as well</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)):</span>
            <span class="c1"># a condition for question to return True or False for numeric value</span>
            <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>  <span class="c1"># categorical data comparison</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="s2">&quot;==&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)):</span>
            <span class="n">condition</span> <span class="o">=</span> <span class="s2">&quot;&gt;=&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Is </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">condition</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2"> ?&quot;</span>


<span class="k">class</span> <span class="nc">DecisionTreeRegressor</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">min_samples_split</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">criteria</span><span class="o">=</span><span class="s1">&#39;variance&#39;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_X</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_feature_names</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_target_name</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tree</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_depth</span> <span class="o">=</span> <span class="n">max_depth</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_samples_split</span> <span class="o">=</span> <span class="n">min_samples_split</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span> <span class="o">=</span> <span class="n">criteria</span>

    <span class="k">def</span> <span class="nf">_mean_leaf_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_partition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rows</span><span class="p">,</span> <span class="n">question</span><span class="p">):</span>
        <span class="n">true_idx</span><span class="p">,</span> <span class="n">false_idx</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">question</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
                <span class="n">true_idx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">false_idx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">true_idx</span><span class="p">,</span> <span class="n">false_idx</span>

    <span class="k">def</span> <span class="nf">_info_gain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">parent_uncertainty</span><span class="p">):</span>

        <span class="n">pr</span> <span class="o">=</span> <span class="n">left</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">left</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">right</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span> <span class="o">==</span> <span class="s2">&quot;variance&quot;</span><span class="p">:</span>
            <span class="n">child_uncertainty</span> <span class="o">=</span> <span class="n">pr</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">left</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">pr</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">right</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="si">}</span><span class="s2"> is not available. Try variance.&quot;</span><span class="p">)</span>

        <span class="n">info_gain_value</span> <span class="o">=</span> <span class="n">parent_uncertainty</span> <span class="o">-</span> <span class="n">child_uncertainty</span>
        <span class="k">return</span> <span class="n">info_gain_value</span>

    <span class="k">def</span> <span class="nf">_find_best_split</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>

        <span class="n">max_gain</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">best_split_question</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span> <span class="o">==</span> <span class="s2">&quot;variance&quot;</span><span class="p">:</span>
            <span class="n">parent_uncertainty</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="si">}</span><span class="s2"> is not available. Try variance.&quot;</span><span class="p">)</span>


        <span class="n">m_samples</span><span class="p">,</span> <span class="n">n_labels</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>

        <span class="k">for</span> <span class="n">col_index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_labels</span><span class="p">):</span>  <span class="c1"># iterate over feature columns</span>
            <span class="c1"># get unique values from the feature</span>
            <span class="n">unique_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="n">col_index</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">unique_values</span><span class="p">:</span>  <span class="c1"># check for every value and find maximum info gain</span>

                <span class="n">ques</span> <span class="o">=</span> <span class="n">Question</span><span class="p">(</span>
                    <span class="n">column_index</span><span class="o">=</span><span class="n">col_index</span><span class="p">,</span>
                    <span class="n">value</span><span class="o">=</span><span class="n">val</span><span class="p">,</span>
                    <span class="n">header</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_feature_names</span><span class="p">[</span><span class="n">col_index</span><span class="p">]</span>
                <span class="p">)</span>

                <span class="n">t_idx</span><span class="p">,</span> <span class="n">f_idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_partition</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">ques</span><span class="p">)</span>
                <span class="c1"># if it does not split the data</span>
                <span class="c1"># skip it</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">t_idx</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">f_idx</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="n">true_y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">t_idx</span><span class="p">,</span> <span class="p">:]</span>
                <span class="n">false_y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">f_idx</span><span class="p">,</span> <span class="p">:]</span>

                <span class="n">gain</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_info_gain</span><span class="p">(</span><span class="n">true_y</span><span class="p">,</span> <span class="n">false_y</span><span class="p">,</span> <span class="n">parent_uncertainty</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">gain</span> <span class="o">&gt;</span> <span class="n">max_gain</span><span class="p">:</span>
                    <span class="n">max_gain</span><span class="p">,</span> <span class="n">best_split_question</span> <span class="o">=</span> <span class="n">gain</span><span class="p">,</span> <span class="n">ques</span>

        <span class="k">return</span> <span class="n">max_gain</span><span class="p">,</span> <span class="n">best_split_question</span><span class="p">,</span> <span class="n">parent_uncertainty</span>

    <span class="k">def</span> <span class="nf">_build_tree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="n">m_samples</span><span class="p">,</span> <span class="n">n_labels</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">depth</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_depth</span> <span class="ow">or</span> <span class="n">n_labels</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">m_samples</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_samples_split</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">Node</span><span class="p">(</span><span class="n">leaf_value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_mean_leaf_value</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>

        <span class="n">gain</span><span class="p">,</span> <span class="n">ques</span><span class="p">,</span> <span class="n">uncertainty</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_best_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">gain</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Node</span><span class="p">(</span><span class="n">leaf_value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_mean_leaf_value</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>

        <span class="n">t_idx</span><span class="p">,</span> <span class="n">f_idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_partition</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">ques</span><span class="p">)</span>
        <span class="n">true_branch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_tree</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">t_idx</span><span class="p">,</span> <span class="p">:],</span> <span class="n">y</span><span class="p">[</span><span class="n">t_idx</span><span class="p">,</span> <span class="p">:],</span> <span class="n">depth</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">false_branch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_tree</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">f_idx</span><span class="p">,</span> <span class="p">:],</span> <span class="n">y</span><span class="p">[</span><span class="n">f_idx</span><span class="p">,</span> <span class="p">:],</span> <span class="n">depth</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Node</span><span class="p">(</span>
            <span class="n">question</span><span class="o">=</span><span class="n">ques</span><span class="p">,</span>
            <span class="n">true_branch</span><span class="o">=</span><span class="n">true_branch</span><span class="p">,</span>
            <span class="n">false_branch</span><span class="o">=</span><span class="n">false_branch</span><span class="p">,</span>
            <span class="n">uncertainty</span><span class="o">=</span><span class="n">uncertainty</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">feature_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">target_name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;O&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">))</span> <span class="k">else</span> <span class="n">X</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;O&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">))</span> <span class="k">else</span> <span class="n">y</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">X</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">y</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_feature_names</span> <span class="o">=</span> <span class="n">feature_name</span> <span class="ow">or</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;C_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_target_name</span> <span class="o">=</span> <span class="n">target_name</span> <span class="ow">or</span> <span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_tree</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_tree</span><span class="p">(</span>
            <span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_X</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_y</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">print_tree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">spacing</span><span class="o">=</span><span class="s2">&quot;|-&quot;</span><span class="p">):</span>

        <span class="n">node</span> <span class="o">=</span> <span class="n">node</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tree</span>

        <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">_is_leaf_node</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">spacing</span><span class="p">,</span> <span class="s2">&quot; Predict :&quot;</span><span class="p">,</span> <span class="n">node</span><span class="o">.</span><span class="n">leaf_value</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="c1"># Print the question at this node</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">spacing</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">question</span><span class="p">)</span> <span class="o">+</span>
              <span class="s2">&quot; | &quot;</span><span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span> <span class="o">+</span><span class="s2">&quot; :&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">uncertainty</span><span class="p">))</span>

        <span class="c1"># Call this function recursively on the true branch</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">spacing</span> <span class="o">+</span> <span class="s1">&#39;--&gt; True:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">print_tree</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">true_branch</span><span class="p">,</span> <span class="s2">&quot;  &quot;</span> <span class="o">+</span> <span class="n">spacing</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span>

        <span class="c1"># Call this function recursively on the false branch</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">spacing</span> <span class="o">+</span> <span class="s1">&#39;--&gt; False:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">print_tree</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">false_branch</span><span class="p">,</span> <span class="s2">&quot;  &quot;</span> <span class="o">+</span> <span class="n">spacing</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_regression</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">_is_leaf_node</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">node</span><span class="o">.</span><span class="n">leaf_value</span>

        <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">question</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_regression</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">node</span><span class="o">.</span><span class="n">true_branch</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_regression</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">node</span><span class="o">.</span><span class="n">false_branch</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
            <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;O&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">))</span> <span class="k">else</span> <span class="n">X</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_regression</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">node</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_tree</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">leaf_value</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">X</span><span class="p">:</span>
                    <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_regression</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span> <span class="n">node</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_tree</span><span class="p">)</span>
                    <span class="n">leaf_value</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">result</span><span class="p">])</span>
                <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">leaf_value</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;O&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;X should be list or numpy array&quot;</span><span class="p">)</span>

</pre></div>
</div>
</div>
</div>
<div class="section" id="id2">
<h3>Testing with Data<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_boston</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">boston_dataset</span> <span class="o">=</span> <span class="n">load_boston</span><span class="p">()</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">boston_dataset</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">],</span><span class="n">columns</span><span class="o">=</span><span class="n">boston_dataset</span><span class="o">.</span><span class="n">feature_names</span><span class="p">)</span>
<span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">boston_dataset</span><span class="p">[</span><span class="s2">&quot;target&quot;</span><span class="p">]</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[[</span><span class="s2">&quot;RM&quot;</span><span class="p">,</span><span class="s2">&quot;AGE&quot;</span><span class="p">,</span><span class="s2">&quot;DIS&quot;</span><span class="p">,</span><span class="s2">&quot;LSTAT&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">boston_dataset</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="n">feature_name</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;RM&quot;</span><span class="p">,</span><span class="s2">&quot;AGE&quot;</span><span class="p">,</span><span class="s2">&quot;DIS&quot;</span><span class="p">,</span><span class="s2">&quot;LSTAT&quot;</span><span class="p">]</span>
<span class="n">X_train</span><span class="p">,</span><span class="n">X_test</span><span class="p">,</span><span class="n">y_train</span><span class="p">,</span><span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span><span class="n">test_size</span><span class="o">=</span><span class="mf">0.10</span><span class="p">)</span>

<span class="n">dt</span> <span class="o">=</span> <span class="n">DecisionTreeRegressor</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">min_samples_split</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">dt</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X_train</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span><span class="n">feature_name</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">feature_name</span><span class="p">))</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">y_test</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">y_pred</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;original&#39;</span><span class="p">,</span><span class="s1">&#39;predicted&#39;</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;original&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;predicted&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>

<span class="n">mean_squared_error</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;original&#39;</span><span class="p">],</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;predicted&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/docs_docs_TreeBasedModels_ExploreDecisionTree_56_0.png" src="../../../_images/docs_docs_TreeBasedModels_ExploreDecisionTree_56_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
53.45240385196718
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_boston</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">boston_dataset</span> <span class="o">=</span> <span class="n">load_boston</span><span class="p">()</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">boston_dataset</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">],</span><span class="n">columns</span><span class="o">=</span><span class="n">boston_dataset</span><span class="o">.</span><span class="n">feature_names</span><span class="p">)</span>
<span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">boston_dataset</span><span class="p">[</span><span class="s2">&quot;target&quot;</span><span class="p">]</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[[</span><span class="s2">&quot;RM&quot;</span><span class="p">,</span><span class="s2">&quot;AGE&quot;</span><span class="p">,</span><span class="s2">&quot;DIS&quot;</span><span class="p">,</span><span class="s2">&quot;LSTAT&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">boston_dataset</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="n">feature_name</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;RM&quot;</span><span class="p">,</span><span class="s2">&quot;AGE&quot;</span><span class="p">,</span><span class="s2">&quot;DIS&quot;</span><span class="p">,</span><span class="s2">&quot;LSTAT&quot;</span><span class="p">]</span>
<span class="n">X_train</span><span class="p">,</span><span class="n">X_test</span><span class="p">,</span><span class="n">y_train</span><span class="p">,</span><span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span><span class="n">test_size</span><span class="o">=</span><span class="mf">0.10</span><span class="p">)</span>

<span class="n">dt</span> <span class="o">=</span> <span class="n">DecisionTreeRegressor</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span><span class="n">min_samples_split</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">dt</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X_train</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span><span class="n">feature_name</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">feature_name</span><span class="p">))</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">y_test</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">y_pred</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;original&#39;</span><span class="p">,</span><span class="s1">&#39;predicted&#39;</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;original&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;predicted&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>

<span class="n">mean_squared_error</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;original&#39;</span><span class="p">],</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;predicted&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/docs_docs_TreeBasedModels_ExploreDecisionTree_57_0.png" src="../../../_images/docs_docs_TreeBasedModels_ExploreDecisionTree_57_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
60.54931460672911
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_boston</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">boston_dataset</span> <span class="o">=</span> <span class="n">load_boston</span><span class="p">()</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">boston_dataset</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">],</span><span class="n">columns</span><span class="o">=</span><span class="n">boston_dataset</span><span class="o">.</span><span class="n">feature_names</span><span class="p">)</span>
<span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">boston_dataset</span><span class="p">[</span><span class="s2">&quot;target&quot;</span><span class="p">]</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[[</span><span class="s2">&quot;RM&quot;</span><span class="p">,</span><span class="s2">&quot;AGE&quot;</span><span class="p">,</span><span class="s2">&quot;DIS&quot;</span><span class="p">,</span><span class="s2">&quot;LSTAT&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">boston_dataset</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="n">feature_name</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;RM&quot;</span><span class="p">,</span><span class="s2">&quot;AGE&quot;</span><span class="p">,</span><span class="s2">&quot;DIS&quot;</span><span class="p">,</span><span class="s2">&quot;LSTAT&quot;</span><span class="p">]</span>
<span class="n">X_train</span><span class="p">,</span><span class="n">X_test</span><span class="p">,</span><span class="n">y_train</span><span class="p">,</span><span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span><span class="n">test_size</span><span class="o">=</span><span class="mf">0.10</span><span class="p">)</span>

<span class="n">dt</span> <span class="o">=</span> <span class="n">DecisionTreeRegressor</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">35</span><span class="p">,</span><span class="n">min_samples_split</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">dt</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X_train</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span><span class="n">feature_name</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">feature_name</span><span class="p">))</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">y_test</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">y_pred</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;original&#39;</span><span class="p">,</span><span class="s1">&#39;predicted&#39;</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;original&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;predicted&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>

<span class="n">mean_squared_error</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;original&#39;</span><span class="p">],</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;predicted&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/docs_docs_TreeBasedModels_ExploreDecisionTree_58_0.png" src="../../../_images/docs_docs_TreeBasedModels_ExploreDecisionTree_58_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
60.61012478090961
</pre></div></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, Nishant Baheti

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>